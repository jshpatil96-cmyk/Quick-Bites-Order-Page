<script>
function downloadReport() {
  let total = 0;

  let table = `
    <table border="1">
      <tr>
        <th>Item</th>
        <th>Quantity</th>
        <th>Price</th>
        <th>Total</th>
      </tr>
  `;

  items.forEach(item => {
    const itemTotal = item.qty * item.price;
    total += itemTotal;
    table += `
      <tr>
        <td>${item.name}</td>
        <td>${item.qty}</td>
        <td>${item.price}</td>
        <td>${itemTotal}</td>
      </tr>
    `;
  });

  table += `
      <tr>
        <td colspan="3"><strong>Grand Total</strong></td>
        <td><strong>${total}</strong></td>
      </tr>
    </table>
  `;

  const html = `
    <html>
      <head><meta charset="UTF-8"></head>
      <body>
        <h3>Quick Bites Stall â€“ Daily Report</h3>
        <p>Date: ${new Date().toLocaleDateString("en-GB")}</p>
        ${table}
      </body>
    </html>
  `;

  const blob = new Blob([html], { type: "application/vnd.ms-excel" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = `QuickBites_Report_${new Date()
    .toLocaleDateString("en-GB")
    .replaceAll("/", "-")}.xls`;
  a.click();

  URL.revokeObjectURL(url);
}
</script>